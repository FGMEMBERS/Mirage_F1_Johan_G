<?xml version="1.0" encoding="UTF-8"?>

<PropertyList>

 <params>
  <adc-indicated-airspeed-kt alias="/instrumentation/airspeed-indicator[1]/indicated-speed-kt"/>
  <adc-indicated-mach alias="/instrumentation/airspeed-indicator[1]/indicated-mach"/>
  <adc-serviceable alias="/systems/air-data-comp/serviceable"/>
  <left-system-indicated-airspeed-kt alias="/instrumentation/airspeed-indicator[0]/indicated-speed-kt"/>
  <left-system-indicated-mach alias="/instrumentation/airspeed-indicator[0]/indicated-mach"/>
  <left-system-serviceable alias="/instrumentation/airspeed-indicator[0]/serviceable"/>
 </params>

 <!--
  Aneroid switches
  
  These are switches connected to the pitot and static systems.
  At certain indicated airspeeds or indicated Mach numbers they will
  close signalling that a limit have passed.
  
  In addition to these ones, signalling the slats and flaps interlocks,
  there are also signals from the air data computer (ADC) and from the
  ADC through the flying aid rack.
  
  The ADC also outputs airspeed limit signals not related to the slats
  and flaps interlocks.
 -->
 
 <logic>
  <name>Flaps aneroid switch, 1st limit</name>
  <input>
   <greater-than>
    <property>/instrumentation/airspeed-indicator[1]/indicated-speed-kt</property>
    <value>300</value>
   </greater-than>
  </input>
  <output>/systems/high-lift-devices/airspeed-aneroid-flaps-1st-lim/indicated-speed-greater-than-300-kt</output>
 </logic>

 <flipflop>
  <name>Flaps aneroid switch, 2nd limit</name>
  <type>SR</type>
  <S>
     <greater-than>
      <property>/instrumentation/airspeed-indicator[0]/indicated-speed-kt</property>
      <value>335</value>
     </greater-than>
  </S>
  <R>
    <less-than>
      <property>/instrumentation/airspeed-indicator[0]/indicated-speed-kt</property>
      <value>320</value>
    </less-than>
  </R>
  <output>/systems/high-lift-devices/airspeed-aneroid-flaps-2nd-lim/indicated-speed-greater-than-335-kt</output>
 </flipflop>

 <logic>
  <name>Slats aneroid switch, 1st limit</name>
  <input>
   <greater-than>
    <property>/instrumentation/airspeed-indicator[1]/indicated-speed-kt</property>
    <value>470</value>
   </greater-than>
  </input>
  <output>/systems/high-lift-devices/airspeed-aneroid-slats-2nd-lim/indicated-speed-greater-than-470-kt</output>
 </logic>

 <logic>
  <name>Mach number switch</name>
  <input>
   <greater-than>
    <property>/instrumentation/airspeed-indicator[0]/indicated-mach</property>
    <value>0.85</value>
   </greater-than>
  </input>
  <output>/systems/high-lift-devices/mach-number-switch/indicated-mach-greater-than-0.85</output>
 </logic>

 <logic>
  <name>Airspeed indicator mach number switch</name>
  <input>
   <greater-than>
    <property>/instrumentation/airspeed-indicator[0]/indicated-mach</property>
    <value>1.1</value>
   </greater-than>
  </input>
  <output>/instrumentation/airspeed-indicator[0]/indicated-mach-greater-than-1.1</output>
 </logic>


 <!--
  Flaps and slats interlocks
  
  These are logic that will drive the automatic extension and
  retraction of the auto slats and the combat flaps to keep them
  retracted outside the safe envelope.
  
  In case the first interlock would malfunction there is a second set
  of interlocks.  If the second interlocks engages without the first
  interlocks already being engaged the caution side (amber) of the
  master failure warning light and the [S/F] light (amber)* on the
  failure warning panel will become lit.
  
  * Only a property for now.
 -->

 <logic>
  <name>Flaps, 1st interlock</name>
  <input>
   <and>
    <or>
     <property>/systems/high-lift-devices/airspeed-aneroid-flaps-1st-lim/indicated-speed-greater-than-300-kt</property>
     <greater-than>
      <!-- Will in time come from the flying aid rack -->
      <property>/instrumentation/airspeed-indicator[1]/indicated-mach</property>
      <value>0.75</value>
     </greater-than>
    </or>
    <!-- greater-than>
     <property>/surface-positions/flap-pos-norm</property>
     <value>0</value>
    </greater-than -->
    <property>/systems/high-lift-devices/flaps/first-interlock-serviceable</property>
   </and>
  </input>
  <output>/systems/high-lift-devices/flaps/first-interlock-enabled</output>
 </logic>

 <logic>
  <name>Flaps, 2nd interlock</name>
  <input>
   <and>
    <or>
     <property>/systems/high-lift-devices/airspeed-aneroid-flaps-2nd-lim/indicated-speed-greater-than-335-kt</property>
     <property>/systems/high-lift-devices/mach-number-switch/indicated-mach-greater-than-0.85</property>
    </or>
    <!-- greater-than>
     <property>/surface-positions/flap-pos-norm</property>
     <value>0</value>
    </greater-than -->
    <property>/systems/high-lift-devices/flaps/second-interlock-serviceable</property>
   </and>
  </input>
  <output>/systems/high-lift-devices/flaps/second-interlock-enabled</output>
  <output>/instrumentation/failure-warning-panel/slats-flaps</output>
  <output>/instrumentation/master-failure-warning/caution</output>
 </logic>

 <logic>
  <name>Slats, 1st interlock</name>
  <input>
   <and>
    <or>
     <greater-than>
      <!-- Will in time come from the air data computer -->
      <property>/instrumentation/airspeed-indicator[1]/indicated-speed-kt</property>
      <value>440</value>
     </greater-than>
     <greater-than>
      <!-- Will in time come from the flying aid rack -->
      <property>/instrumentation/airspeed-indicator[1]/indicated-mach</property>
      <value>0.98</value>
     </greater-than>
    </or>
    <greater-than>
     <property>/surface-positions/slat-pos-norm</property>
     <value>0</value>
    </greater-than>
    <property>/systems/high-lift-devices/slats/first-interlock-serviceable</property>
   </and>
  </input>
  <output>/systems/high-lift-devices/slats/first-interlock-enabled</output>
 </logic>

 <logic>
  <name>Slats, 2nd interlock</name>
  <input>
   <and>
    <or>
     <property>/systems/high-lift-devices/airspeed-aneroid-slats-2nd-lim/indicated-speed-greater-than-470-kt</property>
     <property>/instrumentation/airspeed-indicator[0]/indicated-mach-greater-than-1.1</property>
    </or>
    <greater-than>
     <property>/surface-positions/slat-pos-norm</property>
     <value>0</value>
    </greater-than>
    <property>/systems/high-lift-devices/slats/second-interlock-serviceable</property>
   </and>
  </input>
  <output>/systems/high-lift-devices/slats/second-interlock-enabled</output>
  <output>/instrumentation/failure-warning-panel/slats-flaps</output>
  <output>/instrumentation/master-failure-warning/caution</output>
 </logic>

</PropertyList>
